<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>ViT.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>ViT</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/index-Bby4ubuq.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/preload-helper-BnutJmlU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/chunk-DZLz74EQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/react-cj45iF1i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/compiler-runtime-bbSa6V1W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/jsx-runtime-DmpivWpf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useEventListener-DVwjxFkt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/react-dom-BjyRIiB0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/Combination-ChP9ffHH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/clsx-BlAkgCmw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/cn-BaXqCYqP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/menu-items-DwJgssBv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/hotkeys-jCLisiwR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/button-DCB7VoVL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-CLwJsV2W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/createLucideIcon-DbfgBYhq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/check-DqnGmZZE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/select-BkT3QHmw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/multi-map-DOgPLTwj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/chevron-right-Bu29x-gp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dropdown-menu-CN5aVh8R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/tooltip-fQCr9gxe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_Uint8Array-D5Z9rM2X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_getTag-CVRrQL_Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_baseIsEqual-CVFfFJm2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/jotai-C7U7c6dd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/invariant-D5a0EE05.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/isArrayLikeObject-DKyJYtr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/merge-Dvc5opZF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/zod-U2NFpcFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/utils-GFT-p9ER.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/requests-CftYh9v2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/once-C5bmD4W5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/toDate-CbcWqY6f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_baseSlice-BWZ0PeaJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_arrayMap-DQI2GUNb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/isSymbol-xTSywenE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/toString-CBnct2wx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_hasUnicode-3DIK_jNi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/upperFirst-CBQfDRod.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/capitalize-CBqvgOfA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ai-model-dropdown-6fVxZc7s.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/badge-Dlbidp5Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/use-toast-BBrPeu2N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/constants-CEISdYm1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/Deferred-NfAvvkGM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/config-CULm_ZjE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/uuid-D0hUC3Qw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/key-CaC9xuXQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/connection-DOETP_K0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useLifecycle-DiLWmtpP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useNonce-DJX1XgWY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/capabilities-MLRWIHmO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/createReducer-CTvsuJZY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-C6GW8SWp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-0FJpM7wG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-BFSjfL-I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-BrS3KFEl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-DvTgOH5F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-CZkQ2hcE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-DrAMGx2E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-YP2XXp1Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-CvIoRIOp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/stex-xveX5l_T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/cjs-Ck8KMDI1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_baseProperty-c4IQJQis.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/toNumber-CTOPJrpu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/now-BXqTLlmI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/debounce-BUM2losY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/toInteger-Bor4StOs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/type-CnQq0uaD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/marked.esm-BV7g2d65.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/main-ChjX94eX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/cells-D2eha_-B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/kbd-f3Vl6KVv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/renderShortcut-WvNIumsP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useEvent-2G6_06QI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useDeleteCell-BBvlHSmp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/lazy-DGC5ohlw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/defaultLocale-CNK_a8Z2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/precisionRound-B2LwJfpR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/defaultLocale-Mn032I1s.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/vega-loader.browser-BVwjVCQc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/tooltip-CJwdMp1K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ErrorBoundary-Bu1xrDr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/alert-dialog-81myxzgR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dialog-B0ZQRYmN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useDebounce-88MnHfxr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/numbers-Da0UyJ4q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/SSRProvider-BufkqsXB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/context-CmoHMC3k.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useNumberFormatter-BCRD3Xiy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/usePress-BJP5uSM9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/input-BYmR6HBp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ImperativeModal-wjVZ4eQS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/cell-link-C_YhUpui.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/alert-Uyjokbhs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/links-L8RfsBvj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/state-HLf_9r-5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/MarimoErrorOutput-CAtwsmR1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/spinner-DXjgT_d6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_arrayReduce-DV4IVFuG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/startCase-RfubwhHM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/strings-DoNzvBC8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/command-hjwnCrLr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/popover-y-4eU0xo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useRunCells-DyCvt_J0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/copy-CvoiXuJX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/copy-4VJP-N0g.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/copy-icon-DNw8yyV3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/mode-BvhOdC_B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/purify.es-Cz-BfAJO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/RenderHTML-BPePlDKV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/table-D7dxF_z5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/tabs-DmZtZQ_N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useAsyncData-CXeJJDVW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useIframeCapabilities-CE7UrR0d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/error-banner-C8bnn_Oj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/formats-B6WeWt9C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useTheme-C1t46HlN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/en-US-D9Lph-mE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/isValid-CJoeYwPo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/maps-BGCWjJqb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/shim-CL-N1TlJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/download-3twj9Xwh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/extends-BUnZS06R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/emotion-is-prop-valid.esm-jr96H-64.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useDateFormatter-Bt93nQ51.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/range-ZclXTdAh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/table-CTK995oK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/Output-nN1GOw3k.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/name-cell-input-DFksRedA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useHotkey-DWz-THL8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-ByBamzbc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-BqQuenSr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-CA2lBgvV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-CdeBdpnu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-DLJRvE7V.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-BYOmBsk_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-DyBtC3F_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-BWGrOCqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-CUrxoONf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-CdaKSxCx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-BTy2AO2F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-Bf-v2eRP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-BMjSE6I1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/apl-BbjuiDsS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/asciiarmor-DTXJDFvM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/asn1-By269rpU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/brainfuck-Bcb3sDkN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/clike-D4Hc6kDf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/clojure-Di966kl0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/cmake-EdqYjU-h.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/cobol-CfB_KfUl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/coffeescript-CZnv20P1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/commonlisp-B_wA9NNL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/crystal-B5VE-DHo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/css-CikpO4hp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/cypher-DAN695K7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/d-Cp2O9KNQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/diff-CaYK6FdG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dtd-CKpjjiwC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dylan-BwFScnVi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ecl-DRplsGLw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/eiffel-Uz6uj6V8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/elm-W_885aoq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/erlang-Dm0JOfW3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/simple-mode-H9lcpICo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/factor-Cv1PFcda.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/forth-B_l0qIWF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/fortran-CLxZdPOJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/gas-CWKXfdKr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/gherkin-DlSGfHGe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/groovy-CgF94U6E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/haskell-D8PgguQh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/haxe-GK8_kbF8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/idl-Q7A7KWLA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/javascript-CyIGUINn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/julia-CQO0ko_c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/livescript-CmgdKnEH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/lua-mT6czOLr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/mathematica-yr8Kagso.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/mbox-DwCdX69t.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/mirc-D24moCA0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/mllike-1RsOiz7E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/modelica-Bmw70I7C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/mscgen-Dvk53jZ9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/mumps-CuBXsA1c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/nsis-P2ivpou9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ntriples-CFrQmJZ8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/octave-BE_1B5hT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/oz-B8qIV9R9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/pascal-Dm4iZfnp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/perl-DuC7Sc1M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/pig-Dj3wv73m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/powershell-CJYdAA3Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/properties-CPd1j9nt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/protobuf-BD6S47qV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/pug-BEDx7tiF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/puppet-BRGJzdBr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/python--KWNfsxx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/q-KhF-lSPY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/r-Casg9NL_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/rpm-CLm8BZN9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ruby-kjKq0O38.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/sas-CNUs9bYJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/scheme-H3s5l6ia.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/shell-YvTPydQ4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/sieve-609IkA1k.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/smalltalk-D3NOidyD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/sparql-CC3YRBhS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/stylus-DanbRWv8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/swift-qtGHoPyl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/tcl-0XlfOish.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/textile-BsUNa0ba.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/toml-BkvbWdmE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/troff-BM7wyERf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ttcn-cfg-6rqcHSj6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ttcn-In-Os3qL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/turtle-N2LAl97c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/vb-CHmuFJt3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/vbscript-DwRleoLn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/velocity-DK0DZeo3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/verilog-n25-NWOh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/vhdl-DJ2vn3A6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/webidl-BsEgPfe4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/xquery-Cn6JUpeM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/yacas-ZFTwhpzI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/z80-Ct8aYSc-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/esm-BwqUR0TG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/objectWithoutPropertiesLoose-DuRO3TFS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/esm-DWtLTXrW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/trash-mOekSI_N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ConsoleOutput-Dv7htISD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/icons-DNkkeQqC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/add-missing-import-CMKdLyLj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/blob-ISoY06EG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/add-cell-with-ai-B-hltL9V.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/chart-no-axes-column-C14EHesU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/square-function-zb2K8NSn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/spec-CBVnxwfI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/focus-DkcYPAN0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useInstallPackage-CQfcI_AS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/column-preview-DNqIAgxs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useAddCell-f9BZ2_7O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/toggle-D182En97.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/api-DvkfrUs5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/globals-BbFlbqp7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/share-KKyHVEcH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-B5o2gLy7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/memoize-DhF8x4Aa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_toKey-16owuO_q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_baseSet-L2qemYhz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/utilities.esm-Bmk5DH-t.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/floating-outline-DRYzI4KS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/eye-off-B1gsplPc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/plus-DVSnLdy5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/readonly-python-code-Dr2-5Hjq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/file-video-camera-BakM8DrE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/file-text-br2BVDBF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/file-D9scEdAT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/types-m5vJOc8S.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/label-DoQ8dPQj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/form-C4OqdpTP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/textarea-DxQAjCBZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/circle-x-65ujNh_O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/refresh-ccw-DFz7B_fr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/trash-2-YwvEZLT8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/form-CYnSp8Xw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/field-LInelSvU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/switch-CNBsJN9T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useBoolean-D47R73oR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useDeepCompareMemoize-CGfWpvqN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/LazyAnyLanguageCodeMirror-BmYv6_Y6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/types-PohSL97i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/prop-types-CElKCMhv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/es-IayDfy8U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/VisuallyHidden-fFcUDWss.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_baseFlatten-ViL-mfkw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/get-BUGWIXZE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/hasIn-BgJKauE7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_basePickBy-CSDa7ReR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/pick-BQzWKfma.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/square-C2sucLEB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/code-xml-tuXFIdrH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/download-BYnrx3yk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/globe-CocuQrDy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/send-Cda8V3YD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/refresh-cw-CFk1MA73.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/settings-DukM6PkA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/triangle-alert-BBtcXh_3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/bundle.esm-DtrWSlr6.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/cells-BvrC6Bsv.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/Output-j3zW187k.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ConsoleOutput-BFFTcC5Y.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/index-DWYaH39W.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "ViT.py",
            "mode": "read",
            "version": "0.18.0",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"auto_download": ["html"], "sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "from datasets import load_dataset\nfrom transformers import (\n    AutoImageProcessor,\n    AutoModelForImageClassification,\n    TrainingArguments,\n    Trainer,\n    DefaultDataCollator,\n    set_seed,\n    EarlyStoppingCallback,\n)\nimport evaluate\nimport numpy as np\nimport torch\nimport torchvision.transforms as T\nimport marimo as mo\nimport csv\nimport os\nimport json\n\nset_seed(0)", "code_hash": "8d810e825908045d94790ad097d3a75e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "HAS_CUDA = torch.cuda.is_available()\nHAS_XPU = bool(getattr(torch, \"xpu\", None) and torch.xpu.is_available())\n\nDEVICE = \"cuda\" if HAS_CUDA else (\"xpu\" if HAS_XPU else \"cpu\")\nBF16 = bool(\n    HAS_XPU or (HAS_CUDA and torch.cuda.get_device_capability(0)[0] \u003E= 8)\n)\nFP16 = bool(HAS_CUDA and not BF16)\nPIN_MEM = bool(HAS_CUDA)\n\nif HAS_XPU:\n    # hacky, but gets rid of errors\n    torch.Tensor.double = torch.Tensor.float\n    torch.float64 = torch.double = torch.float32\n# print(DEVICE)\n# torch.set_default_device(DEVICE)", "code_hash": "01187b50b2a11cc98a80e316871e7807", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "# 1) Load folder dataset and make a stratified train/val split\nraw = load_dataset(\n    \"imagefolder\",\n    data_files={\"train\": [\"Data/Alex/**\", \"Data/Kelly/**\"]},\n    split=\"train\",\n)\n# Label names come from subfolder names (e.g., ['Alex', 'Kelly'] in sorted order)\nlabel_names = raw.features[\"label\"].names\nprint(label_names)\nnum_labels = len(label_names)\nassert num_labels == 2, (\n    f\"Expected 2 classes, found {num_labels}: {label_names}\"\n)\n\nsplit = raw.train_test_split(test_size=0.2, stratify_by_column=\"label\", seed=0)", "code_hash": "e44459bb1328bbd083951b0e7a6e5a45", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "train_ds, val_ds = split[\"train\"], split[\"test\"]\n# 2) Image processor + transforms aligned with ViT pretraining\n# checkpoint = \"google/vit-base-patch16-224-in21k\" # not working--cached issue?\ncheckpoint = \"microsoft/swin-base-patch4-window7-224\"\n# checkpoint = \"facebook/deit-base-distilled-patch16-224\" # needs TF\n# checkpoint = \"microsoft/beit-base-patch16-224-pt22k\" # needs Jax\n# checkpoint = \"facebook/dinov2-small\"\nprocessor = AutoImageProcessor.from_pretrained(checkpoint, use_fast=True)\nsize = processor.size.get(\"height\", 224)\n\nnormalize = T.Normalize(mean=processor.image_mean, std=processor.image_std)\n\ntrain_tfms = T.Compose(\n    [\n        T.RandomResizedCrop(size, scale=(0.8, 1.0)),\n        T.RandomHorizontalFlip(),\n        T.ToTensor(),\n        normalize,\n    ]\n)\n\nval_tfms = T.Compose(\n    [\n        T.Resize(int(size * 1.14)),\n        T.CenterCrop(size),\n        T.ToTensor(),\n        normalize,\n    ]\n)\n\n\ndef _transform_train(batch):\n    images = [img.convert(\"RGB\") for img in batch[\"image\"]]\n    return {\n        \"pixel_values\": [train_tfms(img) for img in images],\n        \"labels\": batch[\"label\"],\n    }\n\n\ndef _transform_val(batch):\n    images = [img.convert(\"RGB\") for img in batch[\"image\"]]\n    return {\n        \"pixel_values\": [val_tfms(img) for img in images],\n        \"labels\": batch[\"label\"],\n    }\n\n\ntrain_ds = train_ds.with_transform(_transform_train)\nval_ds = val_ds.with_transform(_transform_val)", "code_hash": "99bbf7d6074635ff4b3867e895d9182a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "# 3) Model head adapted to 2 classes with correct id\u2194label mapping\nlabel2id = {name: i for i, name in enumerate(label_names)}\nid2label = {i: name for name, i in label2id.items()}\n\nmodel = AutoModelForImageClassification.from_pretrained(\n    checkpoint,\n    num_labels=num_labels,\n    label2id=label2id,\n    id2label=id2label,\n    ignore_mismatched_sizes=True,\n)\n\nclean_checkpoint = checkpoint.replace(\"/\", \"_\")\nsave_point = \"weights/\" + clean_checkpoint\nos.makedirs(save_point, exist_ok=True) \n# Freeze the backbone (Swin\u2019s module is `model.swin`, not `model.vit`)\n# backbone = None\n# for attr in (\"swin\", \"vit\", \"convnext\"):\n#     if hasattr(model, attr):\n#         backbone = getattr(model, attr)\n#         break\n# if backbone is None:\n#     raise RuntimeError(\"Could not locate backbone submodule to freeze.\")\n# for p in backbone.parameters():\n#     p.requires_grad = False", "code_hash": "26942dd17c0367e69c626dcb3d5c8a2d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "# 4) Metrics\nacc = evaluate.load(\"accuracy\")\nf1 = evaluate.load(\"f1\")\n\n\ndef compute_metrics(eval_pred):\n    preds = np.argmax(eval_pred.predictions, axis=-1)\n    labels = eval_pred.label_ids\n    return {\n        \"accuracy\": acc.compute(predictions=preds, references=labels)[\n            \"accuracy\"\n        ],\n        \"f1_macro\": f1.compute(\n            predictions=preds, references=labels, average=\"macro\"\n        )[\"f1\"],\n    }\n\n\n# 5) Training\nargs = TrainingArguments(\n    output_dir=save_point,\n    remove_unused_columns=False,\n    learning_rate=5e-5,\n    per_device_train_batch_size=8,\n    per_device_eval_batch_size=8,\n    num_train_epochs=100,  # runaway max epochs--real stopping condition is an increase in validation loss\n    weight_decay=0.01,\n    logging_steps=25,\n    eval_strategy=\"epoch\",\n    save_strategy=\"epoch\",\n    save_total_limit=1,\n    load_best_model_at_end=True,\n    metric_for_best_model=\"eval_accuracy\",  # monitor validation accuracy\n    greater_is_better=True,\n    fp16=False,\n    bf16=True,\n    dataloader_pin_memory=PIN_MEM,\n    optim=\"adamw_torch\",\n)\n\ntrainer = Trainer(\n    model=model,\n    args=args,\n    train_dataset=train_ds,\n    eval_dataset=val_ds,\n    processing_class=processor,\n    data_collator=DefaultDataCollator(),\n    compute_metrics=compute_metrics,\n    callbacks=[\n        EarlyStoppingCallback(\n            early_stopping_patience=4,  # stop if no improvement for 4 evals\n            early_stopping_threshold=0.0,  # require strictly better (set \u003E0 to require margin)\n        )\n    ],\n)", "code_hash": "2c6b21c2491c2fb27d44793c2f55a01a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "trainer.train()", "code_hash": "a673cfdf87b26c182c75e6ccba061053", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "mets = trainer.evaluate(eval_dataset=val_ds)\n\nwith open(os.path.join(save_point, \"metrics.json\"), \"w\") as fi:\n    json.dump(mets, fi, indent=2)\n\ntrainer.args.save_safetensors = False\n# 6) Save for inferencee\ntrainer.save_model(\n    save_point\n)  # saves model + config (incl. id2label/label2id)\nprocessor.save_pretrained(save_point)", "code_hash": "b2510a9f24a283f8232b4c4575e99f9e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "model_eval = AutoModelForImageClassification.from_pretrained(save_point).eval()\nprocessor_eval = AutoImageProcessor.from_pretrained(\n    save_point\n)\n\nhold = load_dataset(\"imagefolder\", data_dir=\"Data/HoldoutSet01\", split=\"train\")\n\nfilenames = [os.path.basename(im.filename) for im in hold[\"image\"]]\n\nhold = hold.with_transform(\n    lambda b: {\n        \"pixel_values\": [val_tfms(im.convert(\"RGB\")) for im in b[\"image\"]]\n    }\n)\n\nlogits = trainer.predict(hold).predictions\npred_ids = logits.argmax(-1)\n\nid2label_holdout = getattr(model_eval.config, \"id2label\", {})\n\nos.makedirs(f\"predictions/{clean_checkpoint}/\", exist_ok=True)\nout_path = f\"predictions/{clean_checkpoint}/holdout_predictions.csv\"\nwith open(out_path, \"w\", newline=\"\", encoding=\"utf-8\") as f:\n    w = csv.writer(f)\n    w.writerow([\"filename\", \"prediction\"])\n    for k, y in zip(filenames, pred_ids.tolist()):\n        w.writerow([k, id2label_holdout.get(int(y), str(int(y)))])\n\nprint(f\"Wrote {len(filenames)} rows to {out_path}\")", "code_hash": "7862deed2163aba36cabd351d659a71c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}], "metadata": {"marimo_version": "0.18.0"}, "version": "1"},
            "session": {"cells": [{"code_hash": "8d810e825908045d94790ad097d3a75e", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "01187b50b2a11cc98a80e316871e7807", "console": [], "id": "MJUe", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "e44459bb1328bbd083951b0e7a6e5a45", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "['Alex', 'Kelly']\n", "type": "stream"}], "id": "vblA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "99bbf7d6074635ff4b3867e895d9182a", "console": [], "id": "bkHC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "26942dd17c0367e69c626dcb3d5c8a2d", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "Some weights of SwinForImageClassification were not initialized from the model checkpoint at microsoft/swin-base-patch4-window7-224 and are newly initialized because the shapes did not match:\n- classifier.bias: found shape torch.Size([1000]) in the checkpoint and torch.Size([2]) in the model instantiated\n- classifier.weight: found shape torch.Size([1000, 1024]) in the checkpoint and torch.Size([2, 1024]) in the model instantiated\nYou should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "type": "stream"}], "id": "lEQa", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "2c6b21c2491c2fb27d44793c2f55a01a", "console": [], "id": "PKri", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "a673cfdf87b26c182c75e6ccba061053", "console": [], "id": "Xref", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003ETrainOutput(global_step=294, training_loss=0.0906912092955745, metrics={\u0026#x27;train_runtime\u0026#x27;: 226.3934, \u0026#x27;train_samples_per_second\u0026#x27;: 171.383, \u0026#x27;train_steps_per_second\u0026#x27;: 21.644, \u0026#x27;total_flos\u0026#x27;: 1.823884535020585e+17, \u0026#x27;train_loss\u0026#x27;: 0.0906912092955745, \u0026#x27;epoch\u0026#x27;: 6.0})\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "b2510a9f24a283f8232b4c4575e99f9e", "console": [], "id": "SFPL", "outputs": [{"data": {"application/json": "[\"weights/microsoft_swin-base-patch4-window7-224\\\\preprocessor_config.json\"]"}, "type": "data"}]}, {"code_hash": "7862deed2163aba36cabd351d659a71c", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Wrote 20 rows to predictions/microsoft_swin-base-patch4-window7-224/holdout_predictions.csv\n", "type": "stream"}], "id": "BYtC", "outputs": [{"data": {"text/html": ""}, "type": "data"}]}], "metadata": {"marimo_version": "0.18.0"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.18.0%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22%2C%20auto_download%3D%5B%22html%22%5D)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20from%20datasets%20import%20load_dataset%0A%20%20%20%20from%20transformers%20import%20(%0A%20%20%20%20%20%20%20%20AutoImageProcessor%2C%0A%20%20%20%20%20%20%20%20AutoModelForImageClassification%2C%0A%20%20%20%20%20%20%20%20TrainingArguments%2C%0A%20%20%20%20%20%20%20%20Trainer%2C%0A%20%20%20%20%20%20%20%20DefaultDataCollator%2C%0A%20%20%20%20%20%20%20%20set_seed%2C%0A%20%20%20%20%20%20%20%20EarlyStoppingCallback%2C%0A%20%20%20%20)%0A%20%20%20%20import%20evaluate%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20torch%0A%20%20%20%20import%20torchvision.transforms%20as%20T%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20csv%0A%20%20%20%20import%20os%0A%20%20%20%20import%20json%0A%0A%20%20%20%20set_seed(0)%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20AutoImageProcessor%2C%0A%20%20%20%20%20%20%20%20AutoModelForImageClassification%2C%0A%20%20%20%20%20%20%20%20DefaultDataCollator%2C%0A%20%20%20%20%20%20%20%20EarlyStoppingCallback%2C%0A%20%20%20%20%20%20%20%20T%2C%0A%20%20%20%20%20%20%20%20Trainer%2C%0A%20%20%20%20%20%20%20%20TrainingArguments%2C%0A%20%20%20%20%20%20%20%20csv%2C%0A%20%20%20%20%20%20%20%20evaluate%2C%0A%20%20%20%20%20%20%20%20json%2C%0A%20%20%20%20%20%20%20%20load_dataset%2C%0A%20%20%20%20%20%20%20%20np%2C%0A%20%20%20%20%20%20%20%20os%2C%0A%20%20%20%20%20%20%20%20torch%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(torch)%3A%0A%20%20%20%20HAS_CUDA%20%3D%20torch.cuda.is_available()%0A%20%20%20%20HAS_XPU%20%3D%20bool(getattr(torch%2C%20%22xpu%22%2C%20None)%20and%20torch.xpu.is_available())%0A%0A%20%20%20%20DEVICE%20%3D%20%22cuda%22%20if%20HAS_CUDA%20else%20(%22xpu%22%20if%20HAS_XPU%20else%20%22cpu%22)%0A%20%20%20%20BF16%20%3D%20bool(%0A%20%20%20%20%20%20%20%20HAS_XPU%20or%20(HAS_CUDA%20and%20torch.cuda.get_device_capability(0)%5B0%5D%20%3E%3D%208)%0A%20%20%20%20)%0A%20%20%20%20FP16%20%3D%20bool(HAS_CUDA%20and%20not%20BF16)%0A%20%20%20%20PIN_MEM%20%3D%20bool(HAS_CUDA)%0A%0A%20%20%20%20if%20HAS_XPU%3A%0A%20%20%20%20%20%20%20%20%23%20hacky%2C%20but%20gets%20rid%20of%20errors%0A%20%20%20%20%20%20%20%20torch.Tensor.double%20%3D%20torch.Tensor.float%0A%20%20%20%20%20%20%20%20torch.float64%20%3D%20torch.double%20%3D%20torch.float32%0A%20%20%20%20%23%20print(DEVICE)%0A%20%20%20%20%23%20torch.set_default_device(DEVICE)%0A%20%20%20%20return%20(PIN_MEM%2C)%0A%0A%0A%40app.cell%0Adef%20_(load_dataset)%3A%0A%20%20%20%20%23%201)%20Load%20folder%20dataset%20and%20make%20a%20stratified%20train%2Fval%20split%0A%20%20%20%20raw%20%3D%20load_dataset(%0A%20%20%20%20%20%20%20%20%22imagefolder%22%2C%0A%20%20%20%20%20%20%20%20data_files%3D%7B%22train%22%3A%20%5B%22Data%2FAlex%2F**%22%2C%20%22Data%2FKelly%2F**%22%5D%7D%2C%0A%20%20%20%20%20%20%20%20split%3D%22train%22%2C%0A%20%20%20%20)%0A%20%20%20%20%23%20Label%20names%20come%20from%20subfolder%20names%20(e.g.%2C%20%5B'Alex'%2C%20'Kelly'%5D%20in%20sorted%20order)%0A%20%20%20%20label_names%20%3D%20raw.features%5B%22label%22%5D.names%0A%20%20%20%20print(label_names)%0A%20%20%20%20num_labels%20%3D%20len(label_names)%0A%20%20%20%20assert%20num_labels%20%3D%3D%202%2C%20(%0A%20%20%20%20%20%20%20%20f%22Expected%202%20classes%2C%20found%20%7Bnum_labels%7D%3A%20%7Blabel_names%7D%22%0A%20%20%20%20)%0A%0A%20%20%20%20split%20%3D%20raw.train_test_split(test_size%3D0.2%2C%20stratify_by_column%3D%22label%22%2C%20seed%3D0)%0A%20%20%20%20return%20label_names%2C%20num_labels%2C%20split%0A%0A%0A%40app.cell%0Adef%20_(AutoImageProcessor%2C%20T%2C%20split)%3A%0A%20%20%20%20train_ds%2C%20val_ds%20%3D%20split%5B%22train%22%5D%2C%20split%5B%22test%22%5D%0A%20%20%20%20%23%202)%20Image%20processor%20%2B%20transforms%20aligned%20with%20ViT%20pretraining%0A%20%20%20%20%23%20checkpoint%20%3D%20%22google%2Fvit-base-patch16-224-in21k%22%20%23%20not%20working--cached%20issue%3F%0A%20%20%20%20checkpoint%20%3D%20%22microsoft%2Fswin-base-patch4-window7-224%22%0A%20%20%20%20%23%20checkpoint%20%3D%20%22facebook%2Fdeit-base-distilled-patch16-224%22%20%23%20needs%20TF%0A%20%20%20%20%23%20checkpoint%20%3D%20%22microsoft%2Fbeit-base-patch16-224-pt22k%22%20%23%20needs%20Jax%0A%20%20%20%20%23%20checkpoint%20%3D%20%22facebook%2Fdinov2-small%22%0A%20%20%20%20processor%20%3D%20AutoImageProcessor.from_pretrained(checkpoint%2C%20use_fast%3DTrue)%0A%20%20%20%20size%20%3D%20processor.size.get(%22height%22%2C%20224)%0A%0A%20%20%20%20normalize%20%3D%20T.Normalize(mean%3Dprocessor.image_mean%2C%20std%3Dprocessor.image_std)%0A%0A%20%20%20%20train_tfms%20%3D%20T.Compose(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20T.RandomResizedCrop(size%2C%20scale%3D(0.8%2C%201.0))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20T.RandomHorizontalFlip()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20T.ToTensor()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20normalize%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%0A%20%20%20%20val_tfms%20%3D%20T.Compose(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20T.Resize(int(size%20*%201.14))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20T.CenterCrop(size)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20T.ToTensor()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20normalize%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%0A%0A%20%20%20%20def%20_transform_train(batch)%3A%0A%20%20%20%20%20%20%20%20images%20%3D%20%5Bimg.convert(%22RGB%22)%20for%20img%20in%20batch%5B%22image%22%5D%5D%0A%20%20%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22pixel_values%22%3A%20%5Btrain_tfms(img)%20for%20img%20in%20images%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22labels%22%3A%20batch%5B%22label%22%5D%2C%0A%20%20%20%20%20%20%20%20%7D%0A%0A%0A%20%20%20%20def%20_transform_val(batch)%3A%0A%20%20%20%20%20%20%20%20images%20%3D%20%5Bimg.convert(%22RGB%22)%20for%20img%20in%20batch%5B%22image%22%5D%5D%0A%20%20%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22pixel_values%22%3A%20%5Bval_tfms(img)%20for%20img%20in%20images%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22labels%22%3A%20batch%5B%22label%22%5D%2C%0A%20%20%20%20%20%20%20%20%7D%0A%0A%0A%20%20%20%20train_ds%20%3D%20train_ds.with_transform(_transform_train)%0A%20%20%20%20val_ds%20%3D%20val_ds.with_transform(_transform_val)%0A%20%20%20%20return%20checkpoint%2C%20processor%2C%20train_ds%2C%20val_ds%2C%20val_tfms%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20AutoModelForImageClassification%2C%0A%20%20%20%20checkpoint%2C%0A%20%20%20%20label_names%2C%0A%20%20%20%20num_labels%2C%0A%20%20%20%20os%2C%0A)%3A%0A%20%20%20%20%23%203)%20Model%20head%20adapted%20to%202%20classes%20with%20correct%20id%E2%86%94label%20mapping%0A%20%20%20%20label2id%20%3D%20%7Bname%3A%20i%20for%20i%2C%20name%20in%20enumerate(label_names)%7D%0A%20%20%20%20id2label%20%3D%20%7Bi%3A%20name%20for%20name%2C%20i%20in%20label2id.items()%7D%0A%0A%20%20%20%20model%20%3D%20AutoModelForImageClassification.from_pretrained(%0A%20%20%20%20%20%20%20%20checkpoint%2C%0A%20%20%20%20%20%20%20%20num_labels%3Dnum_labels%2C%0A%20%20%20%20%20%20%20%20label2id%3Dlabel2id%2C%0A%20%20%20%20%20%20%20%20id2label%3Did2label%2C%0A%20%20%20%20%20%20%20%20ignore_mismatched_sizes%3DTrue%2C%0A%20%20%20%20)%0A%0A%20%20%20%20clean_checkpoint%20%3D%20checkpoint.replace(%22%2F%22%2C%20%22_%22)%0A%20%20%20%20save_point%20%3D%20%22weights%2F%22%20%2B%20clean_checkpoint%0A%20%20%20%20os.makedirs(save_point%2C%20exist_ok%3DTrue)%20%0A%20%20%20%20%23%20Freeze%20the%20backbone%20(Swin%E2%80%99s%20module%20is%20%60model.swin%60%2C%20not%20%60model.vit%60)%0A%20%20%20%20%23%20backbone%20%3D%20None%0A%20%20%20%20%23%20for%20attr%20in%20(%22swin%22%2C%20%22vit%22%2C%20%22convnext%22)%3A%0A%20%20%20%20%23%20%20%20%20%20if%20hasattr(model%2C%20attr)%3A%0A%20%20%20%20%23%20%20%20%20%20%20%20%20%20backbone%20%3D%20getattr(model%2C%20attr)%0A%20%20%20%20%23%20%20%20%20%20%20%20%20%20break%0A%20%20%20%20%23%20if%20backbone%20is%20None%3A%0A%20%20%20%20%23%20%20%20%20%20raise%20RuntimeError(%22Could%20not%20locate%20backbone%20submodule%20to%20freeze.%22)%0A%20%20%20%20%23%20for%20p%20in%20backbone.parameters()%3A%0A%20%20%20%20%23%20%20%20%20%20p.requires_grad%20%3D%20False%0A%20%20%20%20return%20clean_checkpoint%2C%20model%2C%20save_point%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20DefaultDataCollator%2C%0A%20%20%20%20EarlyStoppingCallback%2C%0A%20%20%20%20PIN_MEM%2C%0A%20%20%20%20Trainer%2C%0A%20%20%20%20TrainingArguments%2C%0A%20%20%20%20evaluate%2C%0A%20%20%20%20model%2C%0A%20%20%20%20np%2C%0A%20%20%20%20processor%2C%0A%20%20%20%20save_point%2C%0A%20%20%20%20train_ds%2C%0A%20%20%20%20val_ds%2C%0A)%3A%0A%20%20%20%20%23%204)%20Metrics%0A%20%20%20%20acc%20%3D%20evaluate.load(%22accuracy%22)%0A%20%20%20%20f1%20%3D%20evaluate.load(%22f1%22)%0A%0A%0A%20%20%20%20def%20compute_metrics(eval_pred)%3A%0A%20%20%20%20%20%20%20%20preds%20%3D%20np.argmax(eval_pred.predictions%2C%20axis%3D-1)%0A%20%20%20%20%20%20%20%20labels%20%3D%20eval_pred.label_ids%0A%20%20%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22accuracy%22%3A%20acc.compute(predictions%3Dpreds%2C%20references%3Dlabels)%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22accuracy%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22f1_macro%22%3A%20f1.compute(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20predictions%3Dpreds%2C%20references%3Dlabels%2C%20average%3D%22macro%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%5B%22f1%22%5D%2C%0A%20%20%20%20%20%20%20%20%7D%0A%0A%0A%20%20%20%20%23%205)%20Training%0A%20%20%20%20args%20%3D%20TrainingArguments(%0A%20%20%20%20%20%20%20%20output_dir%3Dsave_point%2C%0A%20%20%20%20%20%20%20%20remove_unused_columns%3DFalse%2C%0A%20%20%20%20%20%20%20%20learning_rate%3D5e-5%2C%0A%20%20%20%20%20%20%20%20per_device_train_batch_size%3D8%2C%0A%20%20%20%20%20%20%20%20per_device_eval_batch_size%3D8%2C%0A%20%20%20%20%20%20%20%20num_train_epochs%3D100%2C%20%20%23%20runaway%20max%20epochs--real%20stopping%20condition%20is%20an%20increase%20in%20validation%20loss%0A%20%20%20%20%20%20%20%20weight_decay%3D0.01%2C%0A%20%20%20%20%20%20%20%20logging_steps%3D25%2C%0A%20%20%20%20%20%20%20%20eval_strategy%3D%22epoch%22%2C%0A%20%20%20%20%20%20%20%20save_strategy%3D%22epoch%22%2C%0A%20%20%20%20%20%20%20%20save_total_limit%3D1%2C%0A%20%20%20%20%20%20%20%20load_best_model_at_end%3DTrue%2C%0A%20%20%20%20%20%20%20%20metric_for_best_model%3D%22eval_accuracy%22%2C%20%20%23%20monitor%20validation%20accuracy%0A%20%20%20%20%20%20%20%20greater_is_better%3DTrue%2C%0A%20%20%20%20%20%20%20%20fp16%3DFalse%2C%0A%20%20%20%20%20%20%20%20bf16%3DTrue%2C%0A%20%20%20%20%20%20%20%20dataloader_pin_memory%3DPIN_MEM%2C%0A%20%20%20%20%20%20%20%20optim%3D%22adamw_torch%22%2C%0A%20%20%20%20)%0A%0A%20%20%20%20trainer%20%3D%20Trainer(%0A%20%20%20%20%20%20%20%20model%3Dmodel%2C%0A%20%20%20%20%20%20%20%20args%3Dargs%2C%0A%20%20%20%20%20%20%20%20train_dataset%3Dtrain_ds%2C%0A%20%20%20%20%20%20%20%20eval_dataset%3Dval_ds%2C%0A%20%20%20%20%20%20%20%20processing_class%3Dprocessor%2C%0A%20%20%20%20%20%20%20%20data_collator%3DDefaultDataCollator()%2C%0A%20%20%20%20%20%20%20%20compute_metrics%3Dcompute_metrics%2C%0A%20%20%20%20%20%20%20%20callbacks%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20EarlyStoppingCallback(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20early_stopping_patience%3D4%2C%20%20%23%20stop%20if%20no%20improvement%20for%204%20evals%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20early_stopping_threshold%3D0.0%2C%20%20%23%20require%20strictly%20better%20(set%20%3E0%20to%20require%20margin)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20)%0A%20%20%20%20return%20(trainer%2C)%0A%0A%0A%40app.cell%0Adef%20_(trainer)%3A%0A%20%20%20%20trainer.train()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(json%2C%20os%2C%20processor%2C%20save_point%2C%20trainer%2C%20val_ds)%3A%0A%20%20%20%20mets%20%3D%20trainer.evaluate(eval_dataset%3Dval_ds)%0A%0A%20%20%20%20with%20open(os.path.join(save_point%2C%20%22metrics.json%22)%2C%20%22w%22)%20as%20fi%3A%0A%20%20%20%20%20%20%20%20json.dump(mets%2C%20fi%2C%20indent%3D2)%0A%0A%20%20%20%20trainer.args.save_safetensors%20%3D%20False%0A%20%20%20%20%23%206)%20Save%20for%20inferencee%0A%20%20%20%20trainer.save_model(%0A%20%20%20%20%20%20%20%20save_point%0A%20%20%20%20)%20%20%23%20saves%20model%20%2B%20config%20(incl.%20id2label%2Flabel2id)%0A%20%20%20%20processor.save_pretrained(save_point)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20AutoImageProcessor%2C%0A%20%20%20%20AutoModelForImageClassification%2C%0A%20%20%20%20clean_checkpoint%2C%0A%20%20%20%20csv%2C%0A%20%20%20%20load_dataset%2C%0A%20%20%20%20os%2C%0A%20%20%20%20save_point%2C%0A%20%20%20%20trainer%2C%0A%20%20%20%20val_tfms%2C%0A)%3A%0A%20%20%20%20model_eval%20%3D%20AutoModelForImageClassification.from_pretrained(save_point).eval()%0A%20%20%20%20processor_eval%20%3D%20AutoImageProcessor.from_pretrained(%0A%20%20%20%20%20%20%20%20save_point%0A%20%20%20%20)%0A%0A%20%20%20%20hold%20%3D%20load_dataset(%22imagefolder%22%2C%20data_dir%3D%22Data%2FHoldoutSet01%22%2C%20split%3D%22train%22)%0A%0A%20%20%20%20filenames%20%3D%20%5Bos.path.basename(im.filename)%20for%20im%20in%20hold%5B%22image%22%5D%5D%0A%0A%20%20%20%20hold%20%3D%20hold.with_transform(%0A%20%20%20%20%20%20%20%20lambda%20b%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22pixel_values%22%3A%20%5Bval_tfms(im.convert(%22RGB%22))%20for%20im%20in%20b%5B%22image%22%5D%5D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%0A%0A%20%20%20%20logits%20%3D%20trainer.predict(hold).predictions%0A%20%20%20%20pred_ids%20%3D%20logits.argmax(-1)%0A%0A%20%20%20%20id2label_holdout%20%3D%20getattr(model_eval.config%2C%20%22id2label%22%2C%20%7B%7D)%0A%0A%20%20%20%20os.makedirs(f%22predictions%2F%7Bclean_checkpoint%7D%2F%22%2C%20exist_ok%3DTrue)%0A%20%20%20%20out_path%20%3D%20f%22predictions%2F%7Bclean_checkpoint%7D%2Fholdout_predictions.csv%22%0A%20%20%20%20with%20open(out_path%2C%20%22w%22%2C%20newline%3D%22%22%2C%20encoding%3D%22utf-8%22)%20as%20f%3A%0A%20%20%20%20%20%20%20%20w%20%3D%20csv.writer(f)%0A%20%20%20%20%20%20%20%20w.writerow(%5B%22filename%22%2C%20%22prediction%22%5D)%0A%20%20%20%20%20%20%20%20for%20k%2C%20y%20in%20zip(filenames%2C%20pred_ids.tolist())%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20w.writerow(%5Bk%2C%20id2label_holdout.get(int(y)%2C%20str(int(y)))%5D)%0A%0A%20%20%20%20print(f%22Wrote%20%7Blen(filenames)%7D%20rows%20to%20%7Bout_path%7D%22)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">81779a97d3bde562120989b38baae4f5</marimo-code-hash>
</body>
</html>
